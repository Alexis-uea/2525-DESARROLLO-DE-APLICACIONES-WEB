{% extends 'base.html' %}

{% block content %}
    <h2>Inventario</h2>

    <!-- Búsqueda por nombre -->
    <form method="post" class="buscar-form">
        <input type="text" name="nombre" placeholder="Buscar por nombre" required>
        <input type="submit" value="Buscar">

        <!-- Botón para ver todo -->
        <a href="{{ url_for('mostrar_inventario') }}">
            <button type="button">Ver todos</button>
        </a>
    </form>

    <!-- Botón para agregar nuevo producto -->
    <a href="{{ url_for('agregar_producto') }}">
        <button>Agregar nuevo producto</button>
    </a>

    <br><br>

    <!-- Tabla con productos -->
    <table border="1" cellpadding="5" cellspacing="0">
        <tr>
            <th>Código</th>
            <th>Nombre</th>
            <th>Cantidad</th>
            <th>Precio</th>
            <th>Acciones</th>
        </tr>

        {% for producto in productos %}
        <tr>
            <td>{{ producto.codigo }}</td>
            <td>{{ producto.nombre }}</td>
            <td>{{ producto.cantidad }}</td>
            <td>${{ "%.2f"|format(producto.precio) }}</td>
            <td>
                <!-- Enlace para editar -->
                <a href="{{ url_for('editar_producto', codigo=producto.codigo) }}">
                    <button>Editar</button>
                </a>

                <!-- Botón de eliminar con protección CSRF -->
                <form action="{{ url_for('eliminar_producto', codigo=producto.codigo) }}" method="post" style="display:inline;">
                    {{ csrf_token() }}
                    <button type="submit" onclick="return confirm('¿Estás seguro de eliminar este producto?')">Eliminar</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>
{% endblock %}
